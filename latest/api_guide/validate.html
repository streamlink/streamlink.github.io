<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html"><link rel="next" title="API Reference" href="../api.html"><link rel="prev" title="Quickstart" href="quickstart.html">
        <link rel="prefetch" href="../_static/icon.svg" as="image">
        <link rel="prefetch" href="../_static/icon.svg" as="image">
        <link rel="prefetch" href="../_static/icon.svg" as="image">

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
  <link rel="apple-touch-icon" sizes="180x180" href="/_static/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/_static/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/_static/favicon-16x16.png">
  <link rel="shortcut icon" href="/_static/favicon.ico">
  <link rel="manifest" href="/_static/site.webmanifest">
  <meta property="og:title" content="Validation schemas - Streamlink 7.6.0+39.g08aed1a documentation">
  <meta property="og:description" content="A command-line utility that extracts streams from various services and pipes them into a video player of choice.">
  <meta property="og:image" content="/_static/opengraph-image.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
        <title>Validation schemas - Streamlink 7.6.0+39.g08aed1a documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/custom.css?v=72de1884" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/fontawesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/solid.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/brands.min.css" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Streamlink 7.6.0+39.g08aed1a documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand centered" href="../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/icon.svg" alt="Streamlink"/>
    <img class="sidebar-logo only-dark" src="../_static/icon.svg" alt="Streamlink"/>
  </div>
  <p class="sidebar-brand-text">Streamlink</p>
  <p class="sidebar-brand-oneliner">A command-line utility that extracts streams from various services and pipes them into a video player of choice.</p>
</a>
<div class="sidebar-versions centered" role="note" aria-label="versions">
  <pre class="sidebar-versions-current">7.6.0+39.g08aed1a</pre>
  <dl class="sidebar-versions-others">
    <dd><a href="/api_guide/validate.html" class="">Stable</a></dd>
    <dd><a href="/latest/api_guide/validate.html" class="version-current">Latest</a></dd>
  </dl>
</div><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cli.html">Command-Line Interface</a><input aria-label="Toggle navigation of Command-Line Interface" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../cli.html">Command-line usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/tutorial.html">Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/config.html">Configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/plugin-sideloading.html">Plugin sideloading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/protocols.html">Streaming protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/proxy.html">Proxy support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/metadata.html">Metadata</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../cli/plugins.html">Plugin specific usage</a><input aria-label="Toggle navigation of Plugin specific usage" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../cli/plugins/twitch.html">Twitch</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../players.html">Players</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deprecations.html">Deprecations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migrations.html">Migrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developing.html">Developing</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../api_guide.html">API Guide</a><input aria-label="Toggle navigation of API Guide" checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Validation schemas</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api.html">API Reference</a><input aria-label="Toggle navigation of API Reference" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/streamlink.html">Streamlink</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/session.html">Session</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/plugin.html">Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/options.html">Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/cache.html">Cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/validate.html">Validation schemas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/stream.html">Stream</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/webbrowser.html">Webbrowser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/exceptions.html">Exceptions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications.html">Streamlink Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thirdparty.html">Third Party Applications</a></li>
</ul>

</div><div class="github-buttons centered">
  <a href="https://github.com/streamlink/streamlink"
    class="github-button"
    data-icon="octicon-mark-github"
    data-count-href="/streamlink/streamlink/stargazers"
    data-count-api="/repos/streamlink/streamlink#stargazers_count">Github</a>
  <a href="https://github.com/streamlink/streamlink/issues"
    class="github-button"
    data-icon="octicon-issue-opened">Issues</a>
  <script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
</div></div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/streamlink/streamlink/blob/master/docs/api_guide/validate.rst?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/streamlink/streamlink/edit/master/docs/api_guide/validate.rst" rel="edit" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          
  
    <div class="admonition important version-warning">
      <p class="admonition-title">You are reading the documentation for the in-development version of Streamlink.</p>
    </div>
  
  <section id="validation-schemas">
<h1>Validation schemas<a class="headerlink" href="#validation-schemas" title="Link to this heading">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>The <a class="reference internal" href="../api/validate.html#validation-schemas"><span class="std std-ref">streamlink.plugin.api.validate</span></a> module provides an API for defining declarative
validation schemas which are used to verify and extract data from various inputs, for example HTTP responses.</p>
<p>Validation schemas are a powerful tool for <a class="reference internal" href="../api/plugin.html#module-streamlink.plugin"><span class="std std-ref">plugin</span></a> implementors to find and extract data like
stream URLs, stream metadata and more from websites and web APIs.</p>
<p>Instead of verifying and extracting data programatically and having to perform error handling manually,
declarative validation schemas allow defining comprehensive validation and extraction rules which are easy to understand
and which raise errors with meaningful messages upon extraction failure.</p>
<div class="caution admonition">
<p class="admonition-title">Public interface</p>
<p>While the internals are implemented in the <code class="docutils literal notranslate"><span class="pre">streamlink.validate</span></code> package,
<a class="reference internal" href="../api/validate.html#validation-schemas"><span class="std std-ref">streamlink.plugin.api.validate</span></a> provides the main public interface
for plugin implementors.</p>
</div>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h2>
<section id="simple-schemas">
<h3>Simple schemas<a class="headerlink" href="#simple-schemas" title="Link to this heading">¶</a></h3>
<p>Let's begin with a few simple validation schemas which are not particularly useful yet.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">streamlink.plugin.api</span><span class="w"> </span><span class="kn">import</span> <span class="n">validate</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">schema_one</span> <span class="o">=</span> <span class="n">validate</span><span class="o">.</span><span class="n">Schema</span><span class="p">(</span><span class="s2">&quot;123&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema_two</span> <span class="o">=</span> <span class="n">validate</span><span class="o">.</span><span class="n">Schema</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema_three</span> <span class="o">=</span> <span class="n">validate</span><span class="o">.</span><span class="n">Schema</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="mf">123.0</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">schema_one</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="s2">&quot;123&quot;</span><span class="p">)</span>
<span class="go">&#39;123&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema_two</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="go">123</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema_three</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="go">123</span>
</pre></div>
</div>
<p>First, three <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.Schema" title="streamlink.plugin.api.validate.Schema"><code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code></a> instances are created, <code class="docutils literal notranslate"><span class="pre">schema_one</span></code>, <code class="docutils literal notranslate"><span class="pre">schema_two</span></code> and <code class="docutils literal notranslate"><span class="pre">schema_three</span></code>.</p>
<p>The <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.Schema" title="streamlink.plugin.api.validate.Schema"><code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code></a> class is the main schema validation interface and the outer wrapper for all schema definitions.
It is a subclass of <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.all" title="streamlink.plugin.api.validate.all"><code class="xref py py-class docutils literal notranslate"><span class="pre">validate.all</span></code></a> which additionally implements the <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.Schema.validate" title="streamlink.plugin.api.validate.Schema.validate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Schema.validate()</span></code></a> method.
This interface is expected by various Streamlink methods and functions when passing the <code class="docutils literal notranslate"><span class="pre">schema</span></code> argument/keyword,
for example to the <a class="reference internal" href="../api/session.html#streamlink.session.Streamlink.http" title="streamlink.session.Streamlink.http"><code class="xref py py-class docutils literal notranslate"><span class="pre">HTTPSession</span></code></a> methods or <code class="xref py py-mod docutils literal notranslate"><span class="pre">streamlink.utils.parse</span></code> functions.</p>
<p>The <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.all" title="streamlink.plugin.api.validate.all"><code class="xref py py-class docutils literal notranslate"><span class="pre">validate.all</span></code></a> class takes a sequence of schema object arguments and validates each one in order.
All schema objects in this schema container must be valid.</p>
<p>Schema objects can be anything, and depending on their type, different validations will be applied. In our example, both
<code class="docutils literal notranslate"><span class="pre">schema_one</span></code> and <code class="docutils literal notranslate"><span class="pre">schema_two</span></code> contain only one schema object, namely <code class="docutils literal notranslate"><span class="pre">&quot;123&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">123</span></code> respectively, whereas
<code class="docutils literal notranslate"><span class="pre">schema_three</span></code> contains two schema objects, <code class="docutils literal notranslate"><span class="pre">int</span></code> and <code class="docutils literal notranslate"><span class="pre">123.0</span></code>. This means that the first two schemas validate
only one condition, while the third one validates two, first <code class="docutils literal notranslate"><span class="pre">int</span></code>, then <code class="docutils literal notranslate"><span class="pre">123.0</span></code>.</p>
<p>As you've probably already noticed, validation schemas also have a return value for their extraction purpose, but this isn't
much interesting in this example.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">&quot;123&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">123</span></code> and <code class="docutils literal notranslate"><span class="pre">123.0</span></code> schemas are simple <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.validate" title="streamlink.plugin.api.validate.validate"><code class="xref py py-func docutils literal notranslate"><span class="pre">equality</span> <span class="pre">validations</span></code></a>. This is the case for
all basic objects, and all they do is validate and return the input value again. <code class="docutils literal notranslate"><span class="pre">int</span></code> however is a <code class="docutils literal notranslate"><span class="pre">type</span></code> object,
and thus a <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate._validate_type" title="streamlink.plugin.api.validate._validate_type"><code class="xref py py-func docutils literal notranslate"><span class="pre">type</span> <span class="pre">validation</span></code></a>, which checks whether the input is an instance of the schema object
and then also returns the input value again. Since <code class="docutils literal notranslate"><span class="pre">123</span></code> is an <code class="docutils literal notranslate"><span class="pre">int</span></code>, the schema is valid for that input.
<code class="docutils literal notranslate"><span class="pre">schema_three</span></code> however hasn't finished validating yet at this point, as it defines two validation schemas in total.
This means that the return value of the <code class="docutils literal notranslate"><span class="pre">int</span></code> validation gets passed to the <code class="docutils literal notranslate"><span class="pre">123.0</span></code> schema validation, and as expected
when checking <code class="docutils literal notranslate"><span class="pre">123</span> <span class="pre">==</span> <span class="pre">123.0</span></code>, despite both the input and schema being different types, namely <code class="docutils literal notranslate"><span class="pre">int</span></code> and <code class="docutils literal notranslate"><span class="pre">float</span></code>,
the validation succeeds and returns its input value again, causing the return value of the whole
<code class="docutils literal notranslate"><span class="pre">schema_three</span></code> to be <code class="docutils literal notranslate"><span class="pre">123</span></code>.</p>
<p>Now let's have a look at validation errors.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">schema_one</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="go">streamlink.exceptions.PluginError: Unable to validate result: ValidationError(equality):</span>
<span class="go">  123 does not equal &#39;123&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">schema_three</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="mf">123.0</span><span class="p">)</span>
<span class="go">streamlink.exceptions.PluginError: Unable to validate result: ValidationError(type):</span>
<span class="go">  Type of 123.0 should be int, but is float</span>
</pre></div>
</div>
<p>The first <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.Schema.validate" title="streamlink.plugin.api.validate.Schema.validate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Schema.validate()</span></code></a> call passes <code class="docutils literal notranslate"><span class="pre">123</span></code> to <code class="docutils literal notranslate"><span class="pre">schema_one</span></code>. <code class="docutils literal notranslate"><span class="pre">schema_one</span></code> however expects <code class="docutils literal notranslate"><span class="pre">&quot;123&quot;</span></code>, so
a <a class="reference internal" href="../api/validate.html#streamlink.validate._exception.ValidationError" title="streamlink.validate._exception.ValidationError"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValidationError</span></code></a> is raised because the input value is not equal to
the schema. <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.Schema.validate" title="streamlink.plugin.api.validate.Schema.validate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Schema.validate()</span></code></a> catches the error and wraps it in
a <a class="reference internal" href="../api/exceptions.html#streamlink.exceptions.PluginError" title="streamlink.exceptions.PluginError"><code class="xref py py-class docutils literal notranslate"><span class="pre">PluginError</span></code></a> with a specific validation message.</p>
<p>The second validation also fails, but here, it's because of the input type. The first sub-schema explicitly checks for
the type <code class="docutils literal notranslate"><span class="pre">int</span></code>, and despite the following schema being <code class="docutils literal notranslate"><span class="pre">123.0</span></code>, which is a <code class="docutils literal notranslate"><span class="pre">float</span></code> object that would obviously validate
a <code class="docutils literal notranslate"><span class="pre">123.0</span></code> <code class="docutils literal notranslate"><span class="pre">float</span></code> input when comparing equality, a <a class="reference internal" href="../api/validate.html#streamlink.validate._exception.ValidationError" title="streamlink.validate._exception.ValidationError"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValidationError</span></code></a>
is raised.</p>
</section>
<section id="extracting-json-data">
<h3>Extracting JSON data<a class="headerlink" href="#extracting-json-data" title="Link to this heading">¶</a></h3>
<p>The next example shows how to read an optional integer value from JSON data.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">streamlink.plugin.api</span><span class="w"> </span><span class="kn">import</span> <span class="n">validate</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">json_schema</span> <span class="o">=</span> <span class="n">validate</span><span class="o">.</span><span class="n">Schema</span><span class="p">(</span>
<span class="gp">... </span>    <span class="nb">str</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">validate</span><span class="o">.</span><span class="n">parse_json</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">validate</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">},</span>
<span class="gp">... </span>    <span class="n">validate</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">json_schema</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;{&quot;status&quot;:null}&quot;&quot;&quot;</span><span class="p">)</span>
<span class="go">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">json_schema</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;{&quot;status&quot;:123}&quot;&quot;&quot;</span><span class="p">)</span>
<span class="go">123</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">json_schema</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Not JSON&quot;&quot;&quot;</span><span class="p">)</span>
<span class="go">streamlink.exceptions.PluginError: Unable to validate result: ValidationError:</span>
<span class="go">  Unable to parse JSON: Expecting value: line 1 column 1 (char 0) (&#39;Not JSON&#39;)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">json_schema</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;{&quot;status&quot;:&quot;unknown&quot;}&quot;&quot;&quot;</span><span class="p">)</span>
<span class="go">streamlink.exceptions.PluginError: Unable to validate result: ValidationError(dict):</span>
<span class="go">  Unable to validate value of key &#39;status&#39;</span>
<span class="go">  Context(AnySchema):</span>
<span class="go">    ValidationError(equality):</span>
<span class="go">      &#39;unknown&#39; does not equal None</span>
<span class="go">    ValidationError(type):</span>
<span class="go">      Type of &#39;unknown&#39; should be int, but is str</span>
</pre></div>
</div>
<p>Once again, we start with a new <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.Schema" title="streamlink.plugin.api.validate.Schema"><code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code></a> object which gets assigned to <code class="docutils literal notranslate"><span class="pre">json_schema</span></code>. This schema collection validates
four schemas in total. Each of them must be valid, with each output being the input of the next one.</p>
<p>Since our goal is to parse JSON data and extract data from it, this means that we should only accept string inputs, so we set
<code class="docutils literal notranslate"><span class="pre">str</span></code> as the first schema in this <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.all" title="streamlink.plugin.api.validate.all"><code class="xref py py-class docutils literal notranslate"><span class="pre">validate.all</span></code></a> schema collection.</p>
<p>Next is the <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.parse_json" title="streamlink.plugin.api.validate.parse_json"><code class="xref py py-func docutils literal notranslate"><span class="pre">validate.parse_json()</span></code></a> validation, a call of a utility function which returns
a <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.transform" title="streamlink.plugin.api.validate.transform"><code class="xref py py-class docutils literal notranslate"><span class="pre">validate.transform</span></code></a> schema object that does exactly what its name suggests: it takes an input and returns
something else. In this case, obviously, strings are the input and a parsed JSON object is the output, assuming that the input
is indeed valid JSON data.</p>
<p>Now we validate the parsed JSON object. We expect the JSON data to be a JSON <code class="docutils literal notranslate"><span class="pre">object</span></code>, so we let the next validation schema
be a <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate._validate_dict" title="streamlink.plugin.api.validate._validate_dict"><code class="xref py py-func docutils literal notranslate"><span class="pre">dict</span> <span class="pre">validation</span></code></a>. <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> validation schemas define a set of key-value pairs which
must exist in the input, unless keys are set as optional using <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.optional" title="streamlink.plugin.api.validate.optional"><code class="xref py py-class docutils literal notranslate"><span class="pre">validate.optional</span></code></a>.
For the sake of simplicity, this isn't the case in this example just yet. Each value of the key-value pairs is
a validation schema on its own where the input is validated against.</p>
<p>Here, the <code class="docutils literal notranslate"><span class="pre">&quot;status&quot;</span></code> key has a <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.any" title="streamlink.plugin.api.validate.any"><code class="xref py py-class docutils literal notranslate"><span class="pre">validate.any</span></code></a> validation schema, which is also a schema collection, similar to
<a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.all" title="streamlink.plugin.api.validate.all"><code class="xref py py-class docutils literal notranslate"><span class="pre">validate.all</span></code></a>, but <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.any" title="streamlink.plugin.api.validate.any"><code class="xref py py-class docutils literal notranslate"><span class="pre">validate.any</span></code></a> requires at least one sub-schema to be valid, not all.
Each sub-schema receives the same input, and the output of the overall schema collection is the output of the first sub-schema
that's valid. For our example, this means that the value of the <code class="docutils literal notranslate"><span class="pre">status</span></code> key in the JSON data must either be
<code class="docutils literal notranslate"><span class="pre">None</span></code> (<code class="docutils literal notranslate"><span class="pre">null</span></code>) or an <code class="docutils literal notranslate"><span class="pre">int</span></code>.</p>
<p>If any of the schemas in a nested schema definition like that fails, then a validation error stack will be generated
by <a class="reference internal" href="../api/validate.html#streamlink.validate._exception.ValidationError" title="streamlink.validate._exception.ValidationError"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValidationError</span></code></a>, as shown above.</p>
<p>The last of the four schemas in the outer <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.all" title="streamlink.plugin.api.validate.all"><code class="xref py py-class docutils literal notranslate"><span class="pre">validate.all</span></code></a> schema collection is a <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.get" title="streamlink.plugin.api.validate.get"><code class="xref py py-class docutils literal notranslate"><span class="pre">validate.get</span></code></a> schema.
This schema works on any kind of input which implements <code class="xref py py-func docutils literal notranslate"><span class="pre">__getitem__()</span></code>, for example <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> objects.
And as expected, it attempts to get and return the <code class="docutils literal notranslate"><span class="pre">&quot;status&quot;</span></code> key of the output of the previous <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> validation.
The <a class="reference internal" href="../api/validate.html#module-streamlink.plugin.api.validate" title="streamlink.plugin.api.validate"><code class="xref py py-mod docutils literal notranslate"><span class="pre">validation</span></code></a> module also supports getting multiple values at once using
the <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.union" title="streamlink.plugin.api.validate.union"><code class="xref py py-class docutils literal notranslate"><span class="pre">validate.union</span></code></a> or <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.union_get" title="streamlink.plugin.api.validate.union_get"><code class="xref py py-class docutils literal notranslate"><span class="pre">validate.union_get</span></code></a> schemas, but this isn't relevant here.</p>
</section>
<section id="finding-stream-urls-in-html">
<h3>Finding stream URLs in HTML<a class="headerlink" href="#finding-stream-urls-in-html" title="Link to this heading">¶</a></h3>
<p>Let's imagine a simple website where a stream URL is embedded as JSON data in a <code class="docutils literal notranslate"><span class="pre">data-player</span></code> attribute of an unknown
HTML element where the web player of that website reads from.</p>
<p>Extracting this data could be done by using regular expressions, but then we'd have to take HTML syntax into account,
as well as JSON syntax which should usually be HTML-encoded in that HTML element attribute, which would make writing
a regular expression even harder, apart from the fact that the JSON data structure could easily change at any time.</p>
<p>Therefore it would make much more sense parsing the HTML data, querying the resulting node tree using an XPath query
for getting the attribute value, then parsing the JSON data and finally finding and validating the stream URL.</p>
<p>We also don't want to raise validation errors unnecessarily when the user inputs a URL where no video player was found,
so we can instead return an empty list of streams in our plugin implementation and let Streamlink's CLI exit gracefully.
Validation errors are only supposed to be raised when an actual error happened due to unexpected data,
not when streams are offline or inaccessible.</p>
<p>Thanks to validation schemas, we can do all this declaratively without causing a mess when doing this programmatically.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">streamlink.plugin.api</span><span class="w"> </span><span class="kn">import</span> <span class="n">validate</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span> <span class="o">=</span> <span class="n">validate</span><span class="o">.</span><span class="n">Schema</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">validate</span><span class="o">.</span><span class="n">parse_html</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="n">validate</span><span class="o">.</span><span class="n">xml_xpath_string</span><span class="p">(</span><span class="s2">&quot;.//*[@data-player][1]/@data-player&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">validate</span><span class="o">.</span><span class="n">none_or_all</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">validate</span><span class="o">.</span><span class="n">parse_json</span><span class="p">(),</span>
<span class="gp">... </span>        <span class="p">{</span>
<span class="gp">... </span>            <span class="n">validate</span><span class="o">.</span><span class="n">optional</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">):</span> <span class="n">validate</span><span class="o">.</span><span class="n">url</span><span class="p">(</span>
<span class="gp">... </span>                <span class="n">path</span><span class="o">=</span><span class="n">validate</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.m3u8&quot;</span><span class="p">),</span>
<span class="gp">... </span>            <span class="p">),</span>
<span class="gp">... </span>        <span class="p">},</span>
<span class="gp">... </span>        <span class="n">validate</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="gp">... </span><span class="s2">    &lt;!doctype html&gt;</span>
<span class="gp">... </span><span class="s2">    &lt;section class=&quot;no-video-player&quot;&gt;&lt;/section&gt;</span>
<span class="gp">... </span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="go">None</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="gp">... </span><span class="s2">    &lt;!doctype html&gt;</span>
<span class="gp">... </span><span class="s2">    &lt;section</span>
<span class="gp">... </span><span class="s2">        class=&quot;video-player&quot;</span>
<span class="gp">... </span><span class="s2">        data-player=&quot;{</span>
<span class="gp">... </span><span class="s2">            &amp;quot;title&amp;quot;:&amp;quot;Offline&amp;quot;</span>
<span class="gp">... </span><span class="s2">        }&quot;</span>
<span class="gp">... </span><span class="s2">    &gt;</span>
<span class="gp">... </span><span class="s2">        ...</span>
<span class="gp">... </span><span class="s2">    &lt;/section&gt;</span>
<span class="gp">... </span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="go">None</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="gp">... </span><span class="s2">    &lt;!doctype html&gt;</span>
<span class="gp">... </span><span class="s2">    &lt;section</span>
<span class="gp">... </span><span class="s2">        class=&quot;video-player&quot;</span>
<span class="gp">... </span><span class="s2">        data-player=&quot;{</span>
<span class="gp">... </span><span class="s2">            &amp;quot;title&amp;quot;:&amp;quot;Live&amp;quot;,</span>
<span class="gp">... </span><span class="s2">            &amp;quot;url&amp;quot;:&amp;quot;https://host/hls-playlist.m3u8&amp;quot;</span>
<span class="gp">... </span><span class="s2">        }&quot;</span>
<span class="gp">... </span><span class="s2">    &gt;</span>
<span class="gp">... </span><span class="s2">        ...</span>
<span class="gp">... </span><span class="s2">    &lt;/section&gt;</span>
<span class="gp">... </span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="go">&#39;https://host/hls-playlist.m3u8&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="gp">... </span><span class="s2">    &lt;!doctype html&gt;</span>
<span class="gp">... </span><span class="s2">    &lt;section</span>
<span class="gp">... </span><span class="s2">        class=&quot;video-player&quot;</span>
<span class="gp">... </span><span class="s2">        data-player=&quot;{</span>
<span class="gp">... </span><span class="s2">            &amp;quot;title&amp;quot;:&amp;quot;Live&amp;quot;,</span>
<span class="gp">... </span><span class="s2">            &amp;quot;url&amp;quot;:&amp;quot;https://host/dash-manifest.mpd&amp;quot;</span>
<span class="gp">... </span><span class="s2">        }&quot;</span>
<span class="gp">... </span><span class="s2">    &gt;</span>
<span class="gp">... </span><span class="s2">        ...</span>
<span class="gp">... </span><span class="s2">    &lt;/section&gt;</span>
<span class="gp">... </span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="go">streamlink.exceptions.PluginError: Unable to validate result: ValidationError(NoneOrAllSchema):</span>
<span class="go">  ValidationError(dict):</span>
<span class="go">    Unable to validate value of key &#39;url&#39;</span>
<span class="go">    Context(url):</span>
<span class="go">      Unable to validate URL attribute &#39;path&#39;</span>
<span class="go">      Context(endswith):</span>
<span class="go">        &#39;/dash-manifest.mpd&#39; does not end with &#39;.m3u8&#39;</span>
</pre></div>
</div>
<p>We start with a new <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.Schema" title="streamlink.plugin.api.validate.Schema"><code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code></a> and begin by parsing HTML using the <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.parse_html" title="streamlink.plugin.api.validate.parse_html"><code class="xref py py-func docutils literal notranslate"><span class="pre">validate.parse_html()</span></code></a>
utility function. Similar to <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.parse_json" title="streamlink.plugin.api.validate.parse_json"><code class="xref py py-func docutils literal notranslate"><span class="pre">validate.parse_json()</span></code></a>, it returns a <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.transform" title="streamlink.plugin.api.validate.transform"><code class="xref py py-class docutils literal notranslate"><span class="pre">validate.transform</span></code></a>
schema. <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.parse_html" title="streamlink.plugin.api.validate.parse_html"><code class="xref py py-func docutils literal notranslate"><span class="pre">validate.parse_html()</span></code></a> however returns a parsed HTML node tree via Streamlink's
<a class="reference internal" href="../install.html#dependencies"><span class="std std-ref">lxml dependency</span></a>.</p>
<p>This is followed by an XPath query schema using the <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.xml_xpath_string" title="streamlink.plugin.api.validate.xml_xpath_string"><code class="xref py py-func docutils literal notranslate"><span class="pre">validate.xml_xpath_string()</span></code></a> utility function.
<a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.xml_xpath_string" title="streamlink.plugin.api.validate.xml_xpath_string"><code class="xref py py-func docutils literal notranslate"><span class="pre">validate.xml_xpath_string()</span></code></a> is a wrapper for <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.xml_xpath" title="streamlink.plugin.api.validate.xml_xpath"><code class="xref py py-func docutils literal notranslate"><span class="pre">validate.xml_xpath()</span></code></a> which always
returns a string or <code class="docutils literal notranslate"><span class="pre">None</span></code>, depending on the query result. This is useful for querying text contents or single attribute
values, like in this case. XPath queries on their own always return a result set, i.e. possibly multiple values, so when
trying to find single values, it is important to limit the number of potential return values to only one in the XPath query.</p>
<p>The query here attempts to find any node with a <code class="docutils literal notranslate"><span class="pre">data-player</span></code> attribute. It then limits the result set to the first found
element and then reads the value of its <code class="docutils literal notranslate"><span class="pre">data-player</span></code> attribute. <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.xml_xpath_string" title="streamlink.plugin.api.validate.xml_xpath_string"><code class="xref py py-func docutils literal notranslate"><span class="pre">validate.xml_xpath_string()</span></code></a>
turns this into a single string return value, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if no or an empty value was returned by the query.</p>
<p>Since we now have two different paths for our overall validation schema, either no player data or still unvalidated player data,
our next schema is a <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.none_or_all" title="streamlink.plugin.api.validate.none_or_all"><code class="xref py py-class docutils literal notranslate"><span class="pre">validate.none_or_all</span></code></a> schema. This works similar to <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.all" title="streamlink.plugin.api.validate.all"><code class="xref py py-class docutils literal notranslate"><span class="pre">validate.all</span></code></a>,
except that <code class="docutils literal notranslate"><span class="pre">None</span></code> inputs are skipped and get returned immediately without validating any sub-schemas. This lets us handle
cases where no player was found on the website, without raising
a <a class="reference internal" href="../api/validate.html#streamlink.validate._exception.ValidationError" title="streamlink.validate._exception.ValidationError"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValidationError</span></code></a>.</p>
<p>In the <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.none_or_all" title="streamlink.plugin.api.validate.none_or_all"><code class="xref py py-class docutils literal notranslate"><span class="pre">validate.none_or_all</span></code></a> schema, we now attempt to parse JSON data, which was already shown
previously, except for the fact that we don't need to validate the <code class="docutils literal notranslate"><span class="pre">str</span></code> input here, as the XPath query must have already
returned a string value.</p>
<p>On to the <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate._validate_dict" title="streamlink.plugin.api.validate._validate_dict"><code class="xref py py-func docutils literal notranslate"><span class="pre">dict</span> <span class="pre">validation</span></code></a>. We're only interested in the <code class="docutils literal notranslate"><span class="pre">url</span></code> key. Any other keys of the input
will get ignored. Since we're aware that <code class="docutils literal notranslate"><span class="pre">url</span></code> can be missing if the stream is offline, we mark it as optional using the
<a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.optional" title="streamlink.plugin.api.validate.optional"><code class="xref py py-class docutils literal notranslate"><span class="pre">validate.optional</span></code></a> schema. This makes the <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate._validate_dict" title="streamlink.plugin.api.validate._validate_dict"><code class="xref py py-func docutils literal notranslate"><span class="pre">dict</span> <span class="pre">validation</span></code></a> not raise an error
if it's missing, but if it's set, then its value must validate. Talking about the value, we want its value to be a URL.</p>
<p>This is where the <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.url" title="streamlink.plugin.api.validate.url"><code class="xref py py-func docutils literal notranslate"><span class="pre">validate.url</span></code></a> utility function comes in handy. It parses the input and lets us validate
any parts of the parsed URL with further validation schemas. The return value is always the full URL string. In our example,
we want to ensure that the URL's path ends with the <code class="docutils literal notranslate"><span class="pre">&quot;.m3u8&quot;</span></code> string, which is an indicator for the stream being
an HLS stream, so we can pass the URL to Streamlink's <a class="reference internal" href="../api/stream.html#streamlink.stream.HLSStream" title="streamlink.stream.HLSStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">HLS</span> <span class="pre">implementation</span></code></a>.</p>
<p>Lastly, we simply get the <code class="docutils literal notranslate"><span class="pre">url</span></code> key using <a class="reference internal" href="../api/validate.html#streamlink.plugin.api.validate.get" title="streamlink.plugin.api.validate.get"><code class="xref py py-class docutils literal notranslate"><span class="pre">validate.get</span></code></a>. The return value must either be <code class="docutils literal notranslate"><span class="pre">None</span></code> if no <code class="docutils literal notranslate"><span class="pre">url</span></code>
key was included in the JSON data, or a <code class="docutils literal notranslate"><span class="pre">str</span></code> with a URL where its path ends with <code class="docutils literal notranslate"><span class="pre">&quot;.m3u8&quot;</span></code>.</p>
<p>This means that the overall schema can only return <code class="docutils literal notranslate"><span class="pre">None</span></code> or said kind of URL string. If the <code class="docutils literal notranslate"><span class="pre">url</span></code> key is not a URL,
or if its path does not end with <code class="docutils literal notranslate"><span class="pre">&quot;.m3u8&quot;</span></code>, then a <a class="reference internal" href="../api/validate.html#streamlink.validate._exception.ValidationError" title="streamlink.validate._exception.ValidationError"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValidationError</span></code></a>
is raised, which is what we want. The <code class="docutils literal notranslate"><span class="pre">None</span></code> return value should then be checked accordingly by the plugin implementation.</p>
</section>
<section id="validating-http-responses">
<h3>Validating HTTP responses<a class="headerlink" href="#validating-http-responses" title="Link to this heading">¶</a></h3>
<p>In order to validate HTTP responses directly, Streamlink's <a class="reference internal" href="../api/session.html#streamlink.session.Streamlink.http" title="streamlink.session.Streamlink.http"><code class="xref py py-class docutils literal notranslate"><span class="pre">HTTPSession</span></code></a> allows
setting the <code class="docutils literal notranslate"><span class="pre">schema</span></code> keyword in <code class="xref py py-meth docutils literal notranslate"><span class="pre">HTTPSession.request()</span></code>,
as well as in each HTTP-verb method like <code class="docutils literal notranslate"><span class="pre">get()</span></code>, <code class="docutils literal notranslate"><span class="pre">post()</span></code>, etc.</p>
<p>Here's a simple plugin implementation with the same schema from the <a class="reference internal" href="#finding-stream-urls-in-html">Finding stream URLs in HTML</a> example above.</p>
<div class="literal-block-wrapper docutils container" id="example-plugin">
<div class="code-block-caption"><span class="caption-text">example-plugin.py</span><a class="headerlink" href="#example-plugin" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">streamlink.plugin</span><span class="w"> </span><span class="kn">import</span> <span class="n">Plugin</span><span class="p">,</span> <span class="n">pluginmatcher</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">streamlink.plugin.api</span><span class="w"> </span><span class="kn">import</span> <span class="n">validate</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">streamlink.stream.hls</span><span class="w"> </span><span class="kn">import</span> <span class="n">HLSStream</span>


<span class="nd">@pluginmatcher</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;https://example\.tld/&quot;</span><span class="p">))</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ExamplePlugin</span><span class="p">(</span><span class="n">Plugin</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_streams</span><span class="p">():</span>
        <span class="n">hls_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">validate</span><span class="o">.</span><span class="n">Schema</span><span class="p">(</span>
            <span class="n">validate</span><span class="o">.</span><span class="n">parse_html</span><span class="p">(),</span>
            <span class="n">validate</span><span class="o">.</span><span class="n">xml_xpath_string</span><span class="p">(</span><span class="s2">&quot;.//*[@data-player][1]/@data-player&quot;</span><span class="p">),</span>
            <span class="n">validate</span><span class="o">.</span><span class="n">none_or_all</span><span class="p">(</span>
                <span class="n">validate</span><span class="o">.</span><span class="n">parse_json</span><span class="p">(),</span>
                <span class="p">{</span>
                    <span class="n">validate</span><span class="o">.</span><span class="n">optional</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">):</span> <span class="n">validate</span><span class="o">.</span><span class="n">url</span><span class="p">(</span>
                        <span class="n">path</span><span class="o">=</span><span class="n">validate</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.m3u8&quot;</span><span class="p">),</span>
                    <span class="p">),</span>
                <span class="p">},</span>
                <span class="n">validate</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">),</span>
            <span class="p">),</span>
        <span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">hls_url</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">HLSStream</span><span class="o">.</span><span class="n">parse_variant_playlist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">,</span> <span class="n">hls_url</span><span class="p">)</span>


<span class="n">__plugin__</span> <span class="o">=</span> <span class="n">ExamplePlugin</span>
</pre></div>
</div>
</div>
</section>
</section>
</section>


        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../api.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">API Reference</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="quickstart.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Quickstart</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Streamlink
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Validation schemas</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#simple-schemas">Simple schemas</a></li>
<li><a class="reference internal" href="#extracting-json-data">Extracting JSON data</a></li>
<li><a class="reference internal" href="#finding-stream-urls-in-html">Finding stream URLs in HTML</a></li>
<li><a class="reference internal" href="#validating-http-responses">Validating HTTP responses</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=bc88eb2b"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    </body>
</html>